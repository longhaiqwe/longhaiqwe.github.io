---
title: 每天5分钟学MySQL内核(1) -- ACID简介
date: 2018-08-26 22:49:31
tags: MySQL内核
---

> 本文采用创作共用署名2.5中国大陆版许可证（Creative Commons Attribution 2.5 China Mainland License）授权。

## 前言

首先，我们从数据库的 ACID 说起。

- 原子性(Atomicity)

  一个事务（transaction）中的所有操作，要么全部完成，要么全部不完成，不会结束在中间某个环节。

- 一致性(Consistency)

  一致性是指数据处于一种语义上的有意义且正确的状态。

  一致性是对数据可见性的约束，保证在一个事务中的多次操作的数据中间状态对其他事务不可见的。

  因为这些中间状态，是一个过渡状态，与事务的开始状态和事务的结束状态是不一致的。

- 隔离性(Isolation)

  数据库允许多个并发事务同时对其数据进行读写和修改的能力，隔离性可以防止多个事务并发执行时由于交叉执行而导致数据的不一致。

- 持久性(Durability)

  指的是只要事务成功结束，它对数据库所做的更新就必须永久保存下来。

  即使发生系统崩溃，重新启动数据库系统后，数据库还能恢复到事务成功结束时的状态。

**特性之间的关联**

- 原子性关注状态，要么全部成功，要么全部失败，不存在部分成功的状态。
- 在未提交读的隔离级别下，会造成脏读，这就是因为一个事务读到了另一个事务操作内部的数据。ACID中是的一致性描述的是一个最理想的事务应该怎样的，是一个强一致性状态，如果要做到这点，需要使用排它锁把事务排成一队，即 Serializable 的隔离级别，这样性能就大大降低了。现实是骨感的，所以使用隔离性的不同隔离级别来破坏一致性，以获取更好的性能。
- 最终一致 ~= 读未提交

> 事务可以不同程度的一致性：
>
> - 强一致性：读操作可以立即读到提交的更新操作。
> - 弱一致性：提交的更新操作，不一定立即会被读操作读到，此种情况会存在一个不一致窗口，指的是读操作可以读到最新值的一段时间。
> - 最终一致性：是弱一致性的特例。事务更新一份数据，最终一致性保证在没有其他事务更新同样的值的话，最终所有的事务都会读到之前事务更新的最新值。如果没有错误发生，不一致窗口的大小依赖于：通信延迟，系统负载等。     
>
> 其他一致性变体还有：
>
> - 单调一致性：如果一个进程已经读到一个值，那么后续不会读到更早的值。
> - 会话一致性：保证客户端和服务器交互的会话过程中，读操作可以读到更新操作后的最新值。

[数据库ACID-维基](https://zh.wikipedia.org/zh-hans/ACID)

[一致性理解-博客](http://geyifan.cn/2016/07/17/talk-about-transaction/)

[一致性理解-知乎](https://www.zhihu.com/question/31346392)